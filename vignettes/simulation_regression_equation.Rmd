---
title: "Simulation from a regression equation"
date: "Created: 2017-11-21 <br> Updated: `r Sys.Date()`"
output: html_notebook
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)

Sys.setenv(TZ = "US/Central")
```

```{r load_packages, message=FALSE}
library(tidyverse)
library(broom)
library(modelr)
```

When you are done tinkering this this file, change the YAML header to a package vignette

# Table of contents {#toc}

-------------------------------------------------------------------------------

* [Simple linear regression model](#simple-linear-regression-model)

# Chapter 11: Simulating data for basic regression models

-------------------------------------------------------------------------------

> A regression model has three parts: the explanatory variables, a random error term, and a model for the response variable.

Wicklin, Rick. Simulating Data with SAS (p. 198). SAS Institute. Kindle Edition. 

> The error term is the source of random variation in the model. When the variance of the error term is small, the response is nearly a deterministic function of the explanatory variables and the parameter estimates have small uncertainty. Use a large variance to investigate how well an algorithm can fit noisy data.

Wicklin, Rick. Simulating Data with SAS (p. 198). SAS Institute. Kindle Edition. 

> For fixed effect models, the errors are usually assumed to have mean zero, constant variance, and be uncorrelated. If you further assume that the errors are normally distributed and independent, you can obtain confidence intervals for the regression parameters.

Wicklin, Rick. Simulating Data with SAS (p. 198). SAS Institute. Kindle Edition. 

## Chosing the variance of the random error term

> For a simple linear regression, the root mean square error (RMSE) is an estimate of the standard deviation of the error term. If this value is known or estimated, the following statement generates the error term: error = rand(“Normal”, 0, RMSE); /* RMSE = std dev of error term */

Wicklin, Rick. Simulating Data with SAS (p. 199). SAS Institute. Kindle Edition. 

## Simple linear regression model

-------------------------------------------------------------------------------

> The simplest regression model is a linear model with a single explanatory variable and with errors that are independently and normally distributed with mean zero and a constant variance.

Wicklin, Rick. Simulating Data with SAS (p. 199). SAS Institute. Kindle Edition. 

### A linear model with a single continuous variable

Suppose that you want to investigate the statistical properties of OLS regression. The following DATA step generates data according to the model Yi = 1 – 2Xi + ∊i where ∊i ~ N(0,0.5). The following DATA step simulates a sample of size 50, and then performs a regression analysis to validate that the simulated data are correct.

Wicklin, Rick. Simulating Data with SAS (p. 200). SAS Institute. Kindle Edition. 

```{r}
N <- 50                                 # Size of each sample
set.seed(1)

x <- runif(n = N)                       # Explanitory variable
eps <- rnorm(n = N, mean = 0, sd = 0.5) # Error term
y <- 1 + (-2 * x) + eps                 # Parameters are 1 and -2

# Not necessary to put into a tibble, but helps later with rmse
df <- tibble(
  x <- x,
  y <- y
)
```

Perform linear regression

```{r}
m <- lm(y ~ x, data = df)
tidy(m)
```

```{r}
modelr::rmse(m, df)
```

> The simulated response, y, was generated according to the regression model. The RMSE is close to 0.5, which is the standard deviation of the random error term, and the parameter estimates are close to the population values of 1 and –2.

Wicklin, Rick. Simulating Data with SAS (p. 201). SAS Institute. Kindle Edition. 















## References

-------------------------------------------------------------------------------

* Simulating data with SAS by Rick Wicklin

* [modelr package documentation](https://github.com/tidyverse/modelr)

* [broom package documentation](https://github.com/tidyverse/broom)


-------------------------------------------------------------------------------

&nbsp;

#### Session Info:
```{r session_info, echo=FALSE}
sessionInfo()
```
